function loadLayers(){for(var e=$("#timestrap"),a=$("#milestones"),t=$(".timestrap-filter"),r=0;r<layers.length;r++){var i=layers[r];if("string"==typeof i&&(a.append('<li class="timestrap-control"><a class="smooth-scroll" href="#'+encodeURIComponent(i)+'">'+i+"</a></li>"),e.append('<div id="'+encodeURIComponent(i)+'" class="timestrap-control"><div class="milestone-wrapper"><div class="milestone">'+i+"</div></div></div>")),i.section)t.append('<option class="timestrap-control" value="'+i.sectionid+'">'+i.section+"</option>"),1==i.visible&&(a.prepend('<li class="'+i.sectionid+' timestrap-control"><a class="smooth-scroll" href="#'+i.sectionid+'">'+i.section+"</li>"),e.append('<div id="'+i.sectionid+'" class="section '+i.sectionid+'"></div>'));else if(i.title){var o=encodeURIComponent(i.title),s=$('<div id="'+o+'" class="panel"></div>').appendTo(e),n=baseUrl+"index.html#"+o;if(i.featured){$('<div class="panel-heading" style="background: #fff url('+i.featured+') no-repeat top center;"></div>').appendTo(s)}var d=$('<div class="panel-body"></div>').appendTo(s),m=($('<h3 class="media-heading">'+i.title+"</h3>").appendTo(d),$('<h4 class="time"><i class="timestrap-share fa fa-fw fa-clock-o"></i></h4>').appendTo(d));i.month&&m.append('<span class="month">&nbsp;'+i.month+",&nbsp;</span>"),i.year&&m.append('<span class="year">'+i.year+"</span>"),i.until&&m.append('<span class="until">&nbsp;&dash;&nbsp;'+i.until+"</span></div>");var p=$('<div class="media"></div>').appendTo(d),h=$('<div class="media-body"></div>').appendTo(p);i.details&&$('<div class="details well">'+i.details+"</div>").appendTo(h),i.link&&($("<h6>References</h6>").appendTo(h),linkList=$('<ol class="references"></ol>').appendTo(h),"string"==typeof i.link?linkList.append('<li role="presentation">'+i.link+"</li>"):_.each(i.link,function(e){linkList.append('<li role="presentation"><a href="'+e+'" title="'+e+'" target="_blank" rel="nofollow">'+e+"</a></li>")}));var g=$('<div class="tags"></div>').appendTo(h);if($('<div class="tag permalink"><a href="'+n+'"><span class="glyphicon glyphicon-heart-empty" aria-hidden="true"></span> permalink</a></div>').appendTo(g),(i.tags||i.category)&&(i.tags&&_.each(i.tags,function(e){$('<div class="tag"><span class="glyphicon glyphicon-tag" aria-hidden="true"></span> '+e+"</div>").appendTo(g)}),i.category&&("string"==typeof i.category?(g.append('<div class="tag"><span class="glyphicon glyphicon-tag" aria-hidden="true"></span> '+i.category+"</div>"),s.addClass(i.category)):_.each(i.category,function(e){g.append('<div class="tag"><span class="glyphicon glyphicon-tag" aria-hidden="true"></span> '+e+"</div>"),s.addClass(e)}))),i.image||i.video){var u=$('<div class="panel-footer"></div>').appendTo(s),f=$('<div class="timestrap-media btn-group btn-group-justified"></div>').appendTo(u);if(i.image)if("string"==typeof i.image){var v=new RegExp("flickr.com");v.test(i.image)?f.append('<a href="'+i.image+'player/" title="'+i.image+'" class="btn btn-default image-link mfp-iframe" target="_blank" rel="nofollow"><img data-original="'+i.image+'player/" class="lazy" alt="image" /></a>'):f.append('<a class="btn btn-default image-link" href="'+i.image+'" target="_blank" rel="nofollow"><img data-original="'+i.image+'" class="lazy" alt="image" /></a>')}else _.each(i.image,function(e){var a=new RegExp("flickr.com");a.test(e)?f.append('<a href="'+e+'player/" title="'+e+'" class="btn btn-default image-link mfp-iframe" target="_blank" rel="nofollow"><img data-original="'+e+'player/" class="lazy" alt="image" /></a>'):f.append('<a class="btn btn-default image-link" href="'+e+'" target="_blank" rel="nofollow"><img data-original="'+e+'" class="lazy" alt="image" /></a>')});i.video&&("string"==typeof i.video?f.append('<a title="View Media" class="btn btn-default video-link mfp-iframe" href="https://www.youtube.com/watch?v='+i.video+'"><div class="videoWrapper"><div class="youtube lazy" id="'+i.video+'" data-original="http://i.ytimg.com/vi/'+i.video+'/sddefault.jpg" data-params="modestbranding=1&showinfo=0&controls=0&vq=hd720" style="width: 765px; height: 574px;"><div class="play"></div></div></div></a>'):_.each(i.video,function(e){f.append('<a title="View Media" class="btn btn-default video-link mfp-iframe" href="https://www.youtube.com/watch?v='+e+'"><div class="videoWrapper"><div class="youtube lazy" data-original="http://i.ytimg.com/vi/'+e+'/sddefault.jpg" data-params="modestbranding=1&showinfo=0&controls=0&vq=hd720" style="width: 765px; height: 574px;"><div class="play"></div></div></div></a>')}))}}}$(".timestrap-media").each(function(){$(this).magnificPopup({delegate:"a",type:"image",gallery:{enabled:!0}})})}$("#slider").nivoSlider({pauseTime:7e3,pauseOnHover:!1});var baseUrl="http://climateviewer.org/geoengineering-timeline/";layers.reverse(),loadLayers(),$(document).ready(function(){function a(){$(".smooth-scroll").click(function(){var a=$.attr(this,"href");return e.animate({scrollTop:$(a).offset().top-90},500,function(){window.location.hash=a}),!1})}$("img.lazy").lazyload({effect:"fadeIn"}),$("div.lazy").lazyload({effect:"fadeIn"}),$("#newest").hide(),$(".container").width()>768?$(".links a").each(function(e,a){var t=$(a),r=t.text();r.length>60&&t.text(r.substring(0,60)+"...")}):$(".links a").each(function(e,a){var t=$(a),r=t.text();r.length>30&&t.text(r.substring(0,30)+"...")}),$(".timestrap-filter").change(function(){var e=$(this).val();return"show-all"==e?($(".timestrap .panel").show(),$(".section").show(),$(".milestone").show()):($(".timestrap .panel").hide(),$(".section").hide(),$(".milestone").hide(),$("."+e).show()),!1});var e=$("html, body");a(),$("#newest").click(function(e){return e.preventDefault(),$("#timestrap").html(""),$(".timestrap-control").remove(),layers.reverse(),loadLayers(),$("#newest").hide(),$("#oldest").show(),a(),$(".section i").removeClass("fa-chevron-down").addClass("fa-chevron-up"),!1}),$("#oldest").click(function(e){return e.preventDefault(),$("#timestrap").html(""),$(".timestrap-control").remove(),layers.reverse(),loadLayers(),$("#newest").show(),$("#oldest").hide(),a(),$(".section i").removeClass("fa-chevron-up").addClass("fa-chevron-down"),!1}),$(".timestrap-share-page").click(function(e){e.preventDefault(),$("#timestrap-share-panel").is(":visible")?($(".timestrap-chart").show(),$(".timestrap-backup").hide(),$("#timestrap-share-panel").hide()):($(".timestrap-chart").hide(),$(".timestrap-backup").hide(),$("#timestrap-share-panel").show())}),$(".timestrap-web-backup").click(function(e){e.preventDefault(),$("#timestrap-backup").is(":visible")?($(".timestrap-chart").show(),$(".timestrap-backup").hide(),$("#timestrap-share-panel").hide()):($(".timestrap-chart").hide(),$(".timestrap-backup").show(),$("#timestrap-share-panel").hide())}),$("#make-backup-submit").click(function(){var e=$("#make-backup").val();window.open("http://web.archive.org/save/"+e)}),$("#view-backup-submit").click(function(){var e=$("#view-backup").val();window.open("http://web.archive.org/web/*/"+e)}),$("#view-backup").keyup(function(e){13==e.keyCode&&$("#view-backup-submit").click()}),$("#make-backup").keyup(function(e){13==e.keyCode&&$("#make-backup-submit").click()});var t=encodeURIComponent("The Weather Effect | The History of Geoengineering and Weather Modification"),r=encodeURIComponent("http://i.imgur.com/JWNH4sA.jpg"),i=encodeURIComponent("The largest weather control database on the internet!  You must see our Geoengineering Timeline, Maps, Patents, Projects, Programs, and References.");$("#timestrap-share-panel").append('<a class="timestrap-share fa fa-fw fa-facebook" target="_blank" href="https://www.facebook.com/dialog/share?app_id=137190086632977&amp;display=page&amp;href='+baseUrl+"&amp;redirect_uri="+baseUrl+'" title="Facebook (share dialog)"></a><a class="timestrap-share fa fa-fw fa-twitter" target="_blank" href="https://twitter.com/share?url='+baseUrl+"&amp;text="+t+'&amp;via=rezn8d&amp;hashtags=wxmod" title="Twitter"></a><a class="timestrap-share fa fa-fw fa-google" target="_blank" href="https://plus.google.com/share?url='+baseUrl+'" title="Google+"></a><a class="timestrap-share fa fa-fw fa-pinterest" target="_blank" href="https://pinterest.com/pin/create/bookmarklet/?media='+r+"&amp;url="+baseUrl+"&amp;description="+t+'" title="Pinterest"></a><a class="timestrap-share fa fa-fw fa-linkedin" target="_blank" href="http://www.linkedin.com/shareArticle?url='+baseUrl+"&amp;title="+t+'" title="Linked In"></a><a class="timestrap-share fa fa-fw fa-digg" target="_blank" href="http://digg.com/submit?url='+baseUrl+"&amp;title="+t+'" title="Digg"></a><a class="timestrap-share fa fa-fw fa-tumblr" target="_blank" href="http://www.tumblr.com/share/link?url='+baseUrl+"&amp;name="+t+"&amp;description="+i+'" title="Tumblr"></a><a class="timestrap-share fa fa-fw fa-reddit" target="_blank" href="http://reddit.com/submit?url='+baseUrl+"&amp;title="+t+'" title="Reddit"></a><a class="timestrap-share fa fa-fw fa-stumbleupon" target="_blank" href="http://www.stumbleupon.com/submit?url='+baseUrl+"&amp;title="+t+'" title="StumbleUpon"></a><a class="timestrap-share fa fa-fw fa-delicious" target="_blank" href="https://delicious.com/save?v=5&amp;jump=close&amp;url='+baseUrl+"&amp;title="+t+'" title="Delicious"></a>'),$(".timestrap-share").click(function(e){e=e?e:window.event;var a=e.target?e.target:e.srcElement,t=a.data-t||800,r=a.data-r||500,i=Math.floor(((screen.availWidth||1024)-t)/2),o=Math.floor(((screen.availHeight||700)-r)/2),s=window.open(a.href,"social","width="+t+",height="+r+",left="+i+",top="+o+",location=0,menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1");return s.focus(),e.preventDefault(),e.returnValue=!1,!!s});var o=$(".panel").length,s=$(".video-link").length,n=$(".image-link").length,l=$(".references li a").length;$(".timestrap-entries").html(o),$(".timestrap-videos").html(s),$(".timestrap-photos").html(n),$(".timestrap-references").html(l);var d=[{value:o,color:"#4DAF7C",highlight:"#55BC75",label:"Timeline Entries"},{value:s,color:"#EAC85D",highlight:"#f9d463",label:"Videos"},{value:n,color:"#E25331",highlight:"#f45e3d",label:"Photos"},{value:l,color:"#1982D1",highlight:"#4BF",label:"Reference Links"}],c=document.getElementById("timestrap-stats").getContext("2d");new Chart(c).Doughnut(d,{responsive:!0,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>"})});